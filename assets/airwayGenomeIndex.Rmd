---
title: "Airway: Genome Index"
author: "Lieven Clement"
date: "statOmics, Ghent University (https://statomics.github.io)"
output:
    html_document:
      code_download: true
      theme: cosmo
      toc: true
      toc_float: true
      highlight: tango
      number_sections: true
---

# Background
The data used in this workflow comes from an RNA-seq experiment where airway smooth muscle cells were treated with dexamethasone, a synthetic glucocorticoid steroid with anti-inflammatory effects (Himes et al. 2014). Glucocorticoids are used, for example, by people with asthma to reduce inflammation of the airways. In the experiment, four human airway smooth muscle cell lines were treated with 1 micromolar dexamethasone for 18 hours. For each of the four cell lines, we have a treated and an untreated sample.
For more description of the experiment see the article, PubMed entry 24926665, and for raw data see the GEO entry GSE52778.

# Intro

In most cases you will have different project on the same organism.
Hence, you will be able to use the same index for all of the projects on the same organism.
We typically do this once and reuse this index over and over again.
I will therefore build the index in a separate script.
Therefore, I will construct the Rsubread index for th
# Data
FastQ files with a small subset of the reads can be found on https://github.com/statOmics/SGA2019/tree/data-rnaseq


```{r}
library("Rsubread")
```

# Build index for Human Chromosome 1

All reads in the subsampled fastq files map to chromosome 1.
We therefore only build an index to chromosome 1 of the human genome so as to save time and disk space.
Normally we build an index using the primary assembly fasta .
We downloaded the fasta data for human from Ensembl (http://www.ensembl.org/info/data/ftp/index.html).  

```{r}
homoGenome<-"Homo_sapiens.GRCh38.dna.chromosome.1.fa.gz"
system("mkdir airway_index")
indexName<-"airway_index/homo_sapiens_GRCh38_dna_chromosome_1_rsubread"
buildindex(basename=indexName,reference=homoGenome)
```
